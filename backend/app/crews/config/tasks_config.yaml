# CrewAI Tasks Configuration
# Defines task templates used in workflows

# ==================== STORY GENERATION TASKS ====================

analyze_user_message:
  description: |
    Analyze the user's message and extract key requirements.

    User Message: {user_message}

    Identify:
    - Main feature or request
    - User goals and pain points
    - Technical constraints or preferences
    - Priority level (if mentioned)

    Provide a structured analysis that can be used for story creation.
  expected_output: |
    A structured analysis containing:
    - Feature summary
    - User goals
    - Key requirements
    - Suggested priority
  agent: team_leader

create_user_story:
  description: |
    Create a comprehensive user story based on the requirements analysis.

    Requirements: {requirements}
    Project Context: {project_context}

    Create a user story following this format:

    **Title**: Clear, concise title (max 60 chars)

    **Description**:
    As a [user type],
    I want [goal],
    So that [benefit].

    **Acceptance Criteria**:
    - Given [context]
      When [action]
      Then [outcome]
    (Include 3-5 criteria)

    **Story Points**: Estimate complexity (1, 2, 3, 5, 8, 13)

    **Type**: UserStory or EnablerStory

    Return as JSON:
    {{
      "title": "...",
      "description": "...",
      "acceptance_criteria": "...",
      "story_point": 5,
      "story_type": "UserStory",
      "priority": 1
    }}
  expected_output: |
    JSON object with user story details including title, description, acceptance criteria, story points, and type.
  agent: business_analyst

estimate_story_complexity:
  description: |
    Estimate the complexity and effort required for the story.

    Story: {story_details}
    Tech Stack: {tech_stack}

    Consider:
    - Technical complexity
    - Dependencies
    - Required expertise
    - Testing effort

    Provide story point estimation (Fibonacci: 1, 2, 3, 5, 8, 13) with justification.
  expected_output: |
    Story point estimation with detailed justification considering complexity, dependencies, and testing.
  agent: developer

# ==================== SPRINT PLANNING TASKS ====================

analyze_backlog:
  description: |
    Analyze the current backlog and identify stories ready for sprint planning.

    Backlog Stories: {backlog_stories}
    Team Velocity: {team_velocity}
    Sprint Capacity: {sprint_capacity}

    Group stories by:
    - Epic/Feature
    - Priority
    - Dependencies
    - Estimated effort

    Recommend stories for the upcoming sprint.
  expected_output: |
    Analysis of backlog with recommended stories for sprint, grouped by epic and priority.
  agent: team_leader

prioritize_stories:
  description: |
    Prioritize stories based on business value, risk, and dependencies.

    Stories: {stories}
    Business Goals: {business_goals}

    For each story, score on:
    - Business value (1-10)
    - User impact (1-10)
    - Risk reduction (1-10)
    - Dependencies (blocker/dependent/independent)

    Provide final priority ranking with justification.
  expected_output: |
    Prioritized list of stories with scores for business value, user impact, and risk.
  agent: product_owner

create_sprint_plan:
  description: |
    Create a comprehensive sprint plan based on prioritized stories.

    Prioritized Stories: {prioritized_stories}
    Team Capacity: {team_capacity}
    Sprint Duration: {sprint_duration} days

    Create plan including:
    - Sprint goal
    - Selected stories (within capacity)
    - Story assignments
    - Risk mitigation strategies

    Return as JSON with sprint details.
  expected_output: |
    JSON object with sprint goal, selected stories, assignments, and risk mitigation strategies.
  agent: team_leader

# ==================== CODE REVIEW TASKS ====================

review_implementation:
  description: |
    Review the implementation for code quality and adherence to requirements.

    Story: {story_details}
    Implementation Plan: {implementation_plan}

    Review for:
    - Requirements coverage
    - Code quality
    - Best practices
    - Security considerations
    - Performance implications

    Provide detailed feedback and approval/rejection recommendation.
  expected_output: |
    Detailed code review with feedback on requirements, quality, security, and performance.
  agent: developer

create_test_plan:
  description: |
    Create a comprehensive test plan for the story.

    Story: {story_details}
    Acceptance Criteria: {acceptance_criteria}

    Create test plan including:
    - Unit test scenarios
    - Integration test scenarios
    - E2E test scenarios
    - Edge cases
    - Test data requirements

    Return as structured test plan.
  expected_output: |
    Structured test plan with unit, integration, and E2E test scenarios including edge cases.
  agent: tester

# ==================== ARCHITECTURE TASKS ====================

design_system_architecture:
  description: |
    Design system architecture for the feature.

    Feature Requirements: {requirements}
    Existing Architecture: {current_architecture}
    Tech Stack: {tech_stack}

    Provide:
    - Component diagram
    - Data flow
    - Technology recommendations
    - Scalability considerations
    - Security measures
  expected_output: |
    System architecture design with components, data flow, technology stack, and scalability considerations.
  agent: architect

# ==================== TASK DEFAULTS ====================

defaults:
  async_execution: false
  human_input: false
  output_json: false
  output_pydantic: null
  tools: []
